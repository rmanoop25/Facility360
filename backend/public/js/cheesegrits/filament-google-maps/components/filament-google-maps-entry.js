function L(e,a){e.src=a}var O=e=>{var a,t,d,_="The Google Maps JavaScript API",n="google",o="importLibrary",g="__ib__",l=document,r=window,u=r[n]||(r[n]={}),i=u.maps||(u.maps={}),s=new Set,p=new URLSearchParams,h=()=>a||(a=new Promise(async(c,m)=>{await(t=l.createElement("script")),p.set("libraries",[...s]+"");for(d in e)p.set(d.replace(/[A-Z]/g,f=>"_"+f[0].toLowerCase()),e[d]);p.set("callback",n+".maps."+g),L(t,"https://maps.googleapis.com/maps/api/js?"+p),i[g]=c,t.onerror=()=>a=m(Error(_+" could not load.")),t.nonce=l.querySelector("script[nonce]")?.nonce||"",l.head.append(t)}));i[o]?console.warn(_+" only loads once. Ignoring:",e):i[o]=(c,...m)=>s.add(c)&&h().then(()=>i[o](c,...m))};var P=e=>`The setOptions() function should only be called once. The options passed to the additional call (${JSON.stringify(e)}) will be ignored.`,A=e=>`The google.maps.importLibrary() function is already defined, and @googlemaps/js-api-loader will use the existing function instead of overwriting it. The options passed to setOptions (${JSON.stringify(e)}) will be ignored.`,T="No options were set before calling importLibrary. Make sure to configure the loader using setOptions().",M="There already is a script loading the Google Maps JavaScript API, and no google.maps.importLibrary function is defined. @googlemaps/js-api-loader will proceed to bootstrap the API with the specified options, but the existing script might cause problems using the API. Make sure to remove the script loading the API.",w=!1,E=w?e=>{console.warn(`[@googlemaps/js-api-loader] ${e}`)}:()=>{},I=w?e=>{console.info(`[@googlemaps/js-api-loader] ${e}`)}:()=>{};var D=!1,y=!1;function b(e){if(y){E(P(e));return}N(e),y=!0}async function v(e){if(y||E(T),!window?.google?.maps?.importLibrary)throw new Error("google.maps.importLibrary is not installed.");return await google.maps.importLibrary(e)}function N(e){let a=!!window.google?.maps?.importLibrary;a?I(A(e)):D&&document.querySelector('script[src*="maps.googleapis.com/maps/api/js"]')&&E(M),a||O(e)}function G({state:e,defaultLocation:a,controls:t,kmlLayers:d,defaultZoom:_,mapEl:n,geoJson:o,geoJsonVisible:g,statePath:l}){let r=null,u=null,i=null,s=null,p={"%n":["street_number"],"%z":["postal_code"],"%S":["street_address","route"],"%A1":["administrative_area_level_1"],"%A2":["administrative_area_level_2"],"%A3":["administrative_area_level_3"],"%A4":["administrative_area_level_4"],"%A5":["administrative_area_level_5"],"%a1":["administrative_area_level_1"],"%a2":["administrative_area_level_2"],"%a3":["administrative_area_level_3"],"%a4":["administrative_area_level_4"],"%a5":["administrative_area_level_5"],"%L":["locality","postal_town"],"%D":["sublocality"],"%C":["country"],"%c":["country"],"%p":["premise"],"%P":["premise"]};return{state:e,init:function(){this.createMap()},async createMap(){b({key:apiKey});let{Map:h}=await v("maps"),{PlacesService:c}=await v("places"),{AdvancedMarkerElement:m}=await v("marker");r=new h(n,{mapId:l,center:this.getCoordinates(),zoom:_,...t}),u=new m({map:r,position:this.getCoordinates()}),i&&(this.layers=i.map(f=>{new google.maps.KmlLayer({url:f,map:r}).addListener("click",S=>{let k=S.featureData.description})})),o&&(g?s=r.data:s=new google.maps.Data,/^http/.test(o)?s.loadGeoJson(o):s.addGeoJson(JSON.parse(o)))},getCoordinates:function(){return(this.state===null||!this.state.hasOwnProperty("lat"))&&(this.state={lat:a.lat,lng:a.lng}),this.state}}}export{G as default};
